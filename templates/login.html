<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIGIMOB - Login</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome para icones -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Definicao da Paleta de Cores como Variaveis CSS */
        :root {
            --clr-ink: #0f172a;
            --clr-muted: #94a3b8;
            --clr-surface: #ffffff;
            --clr-surface-2: #f8fafc;
            --clr-primary: #1d4ed8;
            --clr-primary-2: #2563eb;
            --clr-accent: #0ea5e9;
            --clr-success: #16a34a;
            --clr-attention: #f59e0b;
            --clr-error: #ef4444;
            --clr-shadow: rgba(15, 23, 42, 0.18);
        }

        html, body {
            height: 100%;
        }

        body {
            margin: 0;
            font-family: 'Sora', sans-serif;
            background: radial-gradient(1200px 800px at 10% 10%, rgba(14, 165, 233, 0.18), transparent 55%),
                        radial-gradient(900px 600px at 90% 20%, rgba(37, 99, 235, 0.16), transparent 60%),
                        var(--clr-surface-2);
            color: var(--clr-ink);
            overflow: hidden;
        }

        .flash-message {
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
        }
        .flash-message.success {
            background-color: var(--clr-success);
            color: #fff;
            border: 1px solid var(--clr-success);
        }
        .flash-message.danger {
            background-color: var(--clr-error);
            color: #fff;
            border: 1px solid var(--clr-error);
        }
        .flash-message.warning {
            background-color: var(--clr-attention);
            color: var(--clr-ink);
            border: 1px solid var(--clr-attention);
        }

        .login-shell {
            height: 100vh;
            display: grid;
            grid-template-columns: 1.1fr 0.9fr;
            gap: 0;
        }

        .login-visual {
            position: relative;
            overflow: hidden;
            background: #0b1220;
        }

        .login-visual img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            filter: saturate(1.05) contrast(1.05);
        }

        .login-visual::after {
            content: "";
            position: absolute;
            inset: 0;
            background: linear-gradient(120deg, rgba(2, 6, 23, 0.65), rgba(2, 6, 23, 0.25));
        }

        .login-visual__caption {
            position: absolute;
            left: 6%;
            bottom: 8%;
            z-index: 2;
            color: #fff;
            max-width: 70%;
        }

        .login-visual__caption h2 {
            font-size: clamp(1.5rem, 2.6vw, 2.6rem);
            font-weight: 600;
            letter-spacing: -0.02em;
            margin-bottom: 0.35rem;
        }

        .login-visual__caption p {
            color: rgba(255, 255, 255, 0.75);
            font-weight: 300;
        }

        .login-panel {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: clamp(1.5rem, 4vw, 3rem) clamp(1.25rem, 3vw, 2.5rem);
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.08), rgba(14, 165, 233, 0.06));
            position: relative;
            overflow: hidden;
        }

        .login-panel::before,
        .login-panel::after {
            content: "";
            position: absolute;
            border-radius: 999px;
            filter: blur(0);
            opacity: 0.8;
        }

        .login-panel::before {
            width: 240px;
            height: 240px;
            background: rgba(37, 99, 235, 0.2);
            top: -80px;
            right: -60px;
        }

        .login-panel::after {
            width: 180px;
            height: 180px;
            background: rgba(14, 165, 233, 0.2);
            bottom: -60px;
            left: -40px;
        }

        .login-card {
            width: min(420px, 100%);
            background: rgba(255, 255, 255, 0.92);
            border-radius: 20px;
            padding: clamp(1.5rem, 3.2vw, 2.5rem) clamp(1.4rem, 3vw, 2.25rem) clamp(1.25rem, 2.6vw, 2rem);
            box-shadow: 0 24px 60px var(--clr-shadow);
            backdrop-filter: blur(8px);
            position: relative;
            z-index: 1;
            animation: card-in 0.7s ease-out;
        }

        @keyframes card-in {
            from { transform: translateY(16px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .brand {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.75rem;
        }

        .brand img {
            width: clamp(72px, 12vw, 96px);
            height: clamp(72px, 12vw, 96px);
            border-radius: 20px;
            object-fit: cover;
            box-shadow: 0 12px 26px rgba(15, 23, 42, 0.18);
        }

        .brand h1 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--clr-ink);
        }

        .field {
            position: relative;
            margin-bottom: 1.15rem;
        }

        .field input,
        .field select {
            width: 100%;
            border: 1px solid rgba(148, 163, 184, 0.45);
            background: #fff;
            border-radius: 12px;
            padding: 0.95rem 1rem;
            font-size: 0.95rem;
            color: var(--clr-ink);
            outline: none;
            transition: border 0.2s ease, box-shadow 0.2s ease;
        }

        .field input:focus,
        .field select:focus {
            border-color: var(--clr-primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.12);
        }

        .field label {
            position: absolute;
            top: 50%;
            left: 0.95rem;
            transform: translateY(-50%);
            padding: 0 0.35rem;
            background: #fff;
            color: var(--clr-muted);
            font-size: 0.85rem;
            pointer-events: none;
            transition: 0.2s ease;
        }

        .field input:focus + label,
        .field input:not(:placeholder-shown) + label,
        .field select:focus + label,
        .field select:valid + label {
            top: -0.4rem;
            font-size: 0.72rem;
            color: var(--clr-primary);
        }

        .btn-login {
            width: 100%;
            border: none;
            border-radius: 12px;
            padding: 0.95rem 1rem;
            font-weight: 600;
            letter-spacing: 0.02em;
            background: linear-gradient(120deg, var(--clr-primary), var(--clr-accent));
            color: #fff;
            box-shadow: 0 12px 24px rgba(29, 78, 216, 0.28);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .btn-login:hover {
            transform: translateY(-1px);
            box-shadow: 0 16px 30px rgba(29, 78, 216, 0.32);
        }

        .login-footer {
            margin-top: clamp(0.9rem, 2vw, 1.5rem);
            text-align: center;
            font-size: 0.82rem;
            color: var(--clr-muted);
        }

        .login-footer strong {
            color: var(--clr-ink);
            font-weight: 600;
        }

        .stagger > * {
            opacity: 0;
            transform: translateY(10px);
            animation: stagger-in 0.6s ease forwards;
        }

        .stagger > *:nth-child(1) { animation-delay: 0.05s; }
        .stagger > *:nth-child(2) { animation-delay: 0.12s; }
        .stagger > *:nth-child(3) { animation-delay: 0.19s; }
        .stagger > *:nth-child(4) { animation-delay: 0.26s; }

        @keyframes stagger-in {
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 900px) {
            .login-shell {
                grid-template-columns: 1fr;
            }
            .login-visual {
                display: none;
            }
            .login-panel {
                padding: 2.5rem 1.5rem;
            }
        }

        @media (max-height: 760px) {
            .brand {
                margin-bottom: 1rem;
            }
            .field {
                margin-bottom: 0.85rem;
            }
            .field input,
            .field select {
                padding: 0.75rem 0.9rem;
            }
            .btn-login {
                padding: 0.75rem 0.9rem;
            }
            .login-visual__caption {
                bottom: 5%;
                max-width: 80%;
            }
            .login-visual__caption h2 {
                font-size: clamp(1.2rem, 2.2vw, 2rem);
            }
        }

        @media (max-height: 640px) {
            .login-visual__caption {
                display: none;
            }
            .login-card {
                border-radius: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="login-shell">
        <aside class="login-visual">
            <img src="{{ url_for('static', filename='login-imob.svg') }}" onerror="this.onerror=null;this.src='https://placehold.co/1400x900/0b1220/FFFFFF?text=SIGIMOB';" alt="Imagem de imoveis">
            <div class="login-visual__caption">
                <h2>Gestao imobiliaria com precisao</h2>
                <p>Centralize locacoes, contratos e clientes com seguranca e controle.</p>
            </div>
        </aside>
        <main class="login-panel">
            <div class="login-card">
                <div class="brand">
                    <img src="{{ url_for('static', filename='Logo.png') }}" alt="Logo da Empresa">
                </div>

                <!-- Mensagens Flash -->
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        <div class="mb-6">
                            {% for category, message in messages %}
                                <div class="flash-message {{ category }}">{{ message }}</div>
                            {% endfor %}
                        </div>
                    {% endif %}
                {% endwith %}

                <form action="{{ url_for('login') }}" method="POST" class="stagger">
                    <div class="field">
                        <input type="text" id="username" name="username" required placeholder=" ">
                        <label for="username">Usuario</label>
                    </div>
                    <div class="field">
                        <input type="password" id="password" name="password" required placeholder=" ">
                        <label for="password">Senha</label>
                    </div>
                    {% if empresas %}
                    <div class="field">
                        <select id="empresa_id" name="empresa_id" required>
                            {% for e in empresas %}
                            <option value="{{ e.id }}">{{ e.nome_fantasia }}</option>
                            {% endfor %}
                        </select>
                        <label for="empresa_id">Empresa</label>
                    </div>
                    {% endif %}
                    <div>
                        <button type="submit" class="btn-login">
                            Entrar
                        </button>
                    </div>
                </form>
                <div class="login-footer">
                    <strong>SIGIMOB</strong> | Versao {{ system_version or '1.0' }}
                </div>
            </div>
        </main>
    </div>
    <script src="{{ url_for('static', filename='js/sidebar-toggle.js') }}"></script>
</body>
</html>
